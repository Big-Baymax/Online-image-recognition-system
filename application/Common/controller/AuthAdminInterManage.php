<?php/** * Created by PhpStorm. * User: Baymax * Date: 2018/3/30 * Time: 20:02 */namespace app\Common\Controller;use think\Controller;use think\Session;use think\Auth;use think\Request;use think\Response;use think\exception\HttpResponseException;//使用接口时候做权限认证class AuthAdminInterManage extends Controller{    protected function _initialize()    {        $request = Request::instance();        $id = Session::get('admin_id');        if (!session('admin_id')) {            $result['status'] = 0;            $result['msg'] = '您还没有登陆';            return json($result);        } else {            $auth = new \Auth\Auth();            if(!$auth->check($request->module() .'/'.$request->controller().'/'.$request->action(),$id)){                //$this->error('未登录或者登陆过期，即将跳转到登录页面', './login');               // $result = $auth->getGroups($id);               // var_dump($result);//                $result = $auth->getAuthList($id,1);//                var_dump($result);//                $response = Response::create($result, 'json');//                throw new HttpResponseException($response);                /**                 * @param uid array                 * 请求接口的时候没有权限的话返回自定义的json数据                 */                $result = [                    'status' => 0,                    'msg'  => '没有权限',                ];                //判断请求方式//                $type = $this->getResponseType();//                if ('html' == strtolower($type)) {//                    $result = ViewTemplate::instance(Config::get('template'), Config::get('view_replace_str'))//                        ->fetch(Config::get('dispatch_error_tmpl'), $result);//                }//                var_dump($type);                $response = Response::create($result, 'json');                throw new HttpResponseException($response);            }        }    }}