{extend name="guest@base/user"/}{block name="title"}在线体验{/block}{block name="navbar-four"}<li class="dropdown active">    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">在线体验 <span class="caret"></span></a>    <ul class="dropdown-menu">        <li><a href="_ROOT_/user/interface/example/qrcode">二维码识别</a></li>        <li><a href="_ROOT_/user/interface/example/text">图片转文本</a></li>        <li role="separator" class="divider"></li>        <li><a href="_ROOT_/user/interface/example/color_video">颜色识别</a></li>        <li><a href="_ROOT_/user/interface/example/face_video">人脸识别</a></li>        <li><a href="_ROOT_/user/interface/example/fast">特征值提取</a></li>    </ul></li>{/block}{block name="css"}<style>    video {        width: 100%;        height: 100%        /*position: absolute;*/        /*z-index: 999;*/        /*height: 320px;*/        /*width: 420px;*/    }    .canvas-draw{        position: absolute;        margin: auto;        height: 280px;        width: 360px;        left: 0;        top: 0;        right: 0;        bottom: 0;        /**/        /*!*bottom: 0;*!*/        /*left: 0;*/        /*!*right: 0;*!*/    }    canvas{        width: 100%;        height: 100%;    }    .face-box{        position: relative;        height: 300px;        padding: 0;        margin: 0;    }    #canvas-face{        position: absolute;        top: 0;        right: 0;    }</style>{/block}{block name="contont"}<!-- Begin page content --><div class="container">    <div class="row container-box">        <ul class="example-show" style="padding: 0px">            <li class="active" id="example-1" data="nav-1">                <div class="col-md-12 example-box">                    <!--<div class="col-md-6 example-img-box">-->                    <!--<img src="_IMG_/faces.jpg" class="example-img" id="code">-->                    <!--</div>-->                    <!--<div class="col-md-6 example-img-box">-->                    <!--<div class="example-result">-->                    <!--<h4 class="title">识别结果</h4>-->                    <!--<p class="text" id="code-text"></p>-->                    <!--</div>-->                    <!--</div>-->                    <div class="col-md-12 col-sm-12 example-img-box">                        <div class="col-md-6 face-box">                            <div class="canvas-draw">                                <img id="fast" src="_IMG_/fast.png" class="example-img" width="400" height="400">                            </div>                            <span class="img-title">原图</span>                        </div>                        <div class="col-md-6 face-box">                            <div class="canvas-draw">                                <img id="fast-img" src="_IMG_/fast.png" class="example-img" width="400" height="400">                                <canvas id="canvas-face" width="400" height="400"></canvas>                            </div>                            <span class="img-title">效果图</span>                        </div>                    </div>                    <div class="col-md-12">                        <p class="text-center" style="font-size: 25px">特征值</p>                        <textarea id="fast-val" class="form-control" rows="12"></textarea>                    </div>                    <div class="col-md-12 example-upload">                        <button type="button" class="btn btn-lg btn-orange example-btn">本地上传</button>                        <input id="file" type="file" accept="image/*" style="display: none">                    </div>                </div>            </li>        </ul>        <div class="col-md-12 sideGuide text-center">            <ul class="center-block">                <li><a href="fast" class="example-nav active">照片特征值</a></li>                <li><a href="fast_video" class="example-nav">录像特征值</a></li>            </ul>        </div>    </div></div>{/block}{block name="linkjs"}<script src="_ROOT_/faces?key=4e6df7ac7ebee8ae5e35aee876ddd2a5"></script><script src="_JS_/im/dat-gui/dat.gui.min.js"></script>{/block}{block name="js"}<script>    window.onload = function() {        window.fastThreshold = 10;        var doFindFeatures = function(url,canvas) {            var width = 400;            var height = 400;            //var canvas = document.getElementById('canvas-face');            var context = canvas.getContext('2d');            //canvas.clearRect(0,0,canvas.width,canvas.height);            //var image = ;            image = new Image();            image.src = url;            image.onload = function(){                context.drawImage(image, 0, 0, width, height);                tracking.Fast.THRESHOLD = window.fastThreshold;                // context.fillRect(0,0,width,height);                //context.clearRect(0,0,width,height);                var imageData = context.getImageData(0, 0, width, height);                //console.log(imageData);                var gray = tracking.Image.grayscale(imageData.data, width, height);                var corners = tracking.Fast.findCorners(gray, width, height);                console.log(corners);                $("#fast-val").val(corners);                for (var i = 0; i < corners.length; i += 2) {                    context.fillStyle = '#f00';                    context.fillRect(corners[i], corners[i + 1], 3, 3);                }                //console.log('你好啊！'+image.src);            };        };       doFindFeatures("_IMG_/fast.png",document.getElementById('canvas-face'));        var gui = new dat.GUI();        gui.add(window, 'fastThreshold', 0, 100).onChange(doFindFeatures);        //获取文件路径方法兼容        function getObjectURL(file) {            var url = null ;            if (window.createObjectURL!=undefined) { // basic                url = window.createObjectURL(file) ;            } else if (window.URL!=undefined) { // mozilla(firefox)                url = window.URL.createObjectURL(file) ;            } else if (window.webkitURL!=undefined) { // webkit or chrome                url = window.webkitURL.createObjectURL(file) ;            }            return url ;        }        $('.example-btn').on('click',function () {            var input = $(this).siblings('input');            input.click();        });        $("#file").change(function () {            //判断是否支持FileReader            if (window.FileReader) {                var reader = new FileReader();            } else {                alert("您的设备不支持图片预览功能，如需该功能请升级您的设备！");            }            //获取文件            var file = this.files[0];            var imageType = /^image\//;            //是否是图片            if (!imageType.test(file.type)) {                alert("请选择图片！");                return;            }            //读取完成            reader.onload = function(e) {                //获取图片dom                var img = document.getElementById("fast");                //图片路径设置为读取的图片                img.src = e.target.result;                var img_fast = document.getElementById("fast-img");                //图片路径设置为读取的图片                img_fast.src = e.target.result;                doFindFeatures(e.target.result,document.getElementById('canvas-face'));            };            reader.readAsDataURL(file);            //$('#'+id+'-text').html('<i class="fa fa-spinner fa-pulse fa-5x"></i><br>正在识别，请稍等……');//            var objUrl = getObjectURL(this.files[0]);//            $('#fast').attr('src',objUrl);//            $('#fast-img').attr('src',objUrl);            //font_discern(objUrl,$('#'+id+'-text'));        });    }</script>{/block}