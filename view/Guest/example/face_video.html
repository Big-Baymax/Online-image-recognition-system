{extend name="guest@base/user"/}{block name="title"}在线体验--人脸识别{/block}{block name="navbar-four"}<li class="dropdown active">    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">在线体验 <span class="caret"></span></a>    <ul class="dropdown-menu">        <li><a href="_ROOT_/user/interface/example/qrcode">二维码识别</a></li>        <li><a href="_ROOT_/user/interface/example/text">图片转文本</a></li>        <li role="separator" class="divider"></li>        <li><a href="_ROOT_/user/interface/example/color_video">颜色识别</a></li>        <li><a href="_ROOT_/user/interface/example/face_video">人脸识别</a></li>        <li><a href="_ROOT_/user/interface/example/fast">特征值提取</a></li>    </ul></li>{/block}{block name="css"}<style>    video {        width: 100%;        height: 100%    }    .canvas-draw{        position: absolute;        margin: auto;        height: 420px;        width: 560px;        left: 0;        top: 0;        right: 0;        bottom: 0;    }    canvas{        width: 100%;        height: 100%;    }    .face-box{        position: relative;        height: 430px;        padding: 0;        margin: 0;    }</style>{/block}{block name="contont"}<!-- Begin page content --><div class="container">    <div class="row container-box">        <ul class="example-show" style="padding: 0px">            <li class="active" id="example-2" data="nav-2">                <div class="col-md-12 example-box">                    <div class="col-md-12 face-box">                        <div class="canvas-draw">                            <video id="video" width="560" height="420" preload autoplay loop muted></video>                        </div>                        <div class="canvas-draw">                            <canvas id="canvas" width="560" height="420"></canvas>                        </div>                    </div>                </div>            </li>        </ul>        <div class="col-md-12 sideGuide text-center">            <ul class="center-block">                <li><a href="face_video" class="example-nav active">录像人脸识别</a></li>                <li><a href="face_pic" class="example-nav">照片人脸标记</a></li>            </ul>        </div>    </div></div>{/block}{block name="linkjs"}<script src="_ROOT_/faces?key=4e6df7ac7ebee8ae5e35aee876ddd2a5"></script><script src="_JS_/im/training/build/data/face-min.js"></script><script src="_JS_/im/training/src/alignment/training/Landmarks.js"></script><script src="_JS_/im/training/src/alignment/training/Regressor.js"></script><script src="_JS_/im/dat-gui/dat.gui.min.js"></script>{/block}{block name="js"}<script>    window.onload = function() {        var video = document.getElementById('video');        var canvas = document.getElementById('canvas');        var context = canvas.getContext('2d');        var tracker = new tracking.LandmarksTracker();        tracker.setInitialScale(4);        tracker.setStepSize(2);        tracker.setEdgesDensity(0.1);        tracking.track('#video', tracker, { camera: true });        tracker.on('track', function(event) {            context.clearRect(0,0,canvas.width, canvas.height);            if(!event.data) return;            event.data.faces.forEach(function(rect) {                context.strokeStyle = '#a64ceb';                //设置线的大小                //context.lineWidth = 5;                context.strokeRect(rect.x, rect.y, rect.width, rect.height);                context.font = '11px Helvetica';                context.fillStyle = "#fff";                context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);                context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);            });            event.data.landmarks.forEach(function(landmarks) {                for(var l in landmarks){                    context.beginPath();                    context.fillStyle = "#fff"                    context.arc(landmarks[l][0],landmarks[l][1],1,0,2*Math.PI);                    context.fill();                }            });        });    };</script>{/block}