{extend name="guest@base/user"/}{block name="title"}在线体验{/block}{block name="navbar-four"}<li class="dropdown active">    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">在线体验 <span class="caret"></span></a>    <ul class="dropdown-menu">        <li><a href="_ROOT_/user/interface/example#example-1">二维码识别</a></li>        <li><a href="_ROOT_/user/interface/example#example-3">图片转文本</a></li>        <li role="separator" class="divider"></li>        <li><a href="_ROOT_/user/interface/example/color_video">颜色识别</a></li>        <li><a href="_ROOT_/user/interface/example/face_video">人脸识别</a></li>        <li><a href="_ROOT_/user/interface/example/fast">特征值提取</a></li>    </ul></li>{/block}{block name="css"}<style>    video {        width: 100%;        height: 100%        /*position: absolute;*/        /*z-index: 999;*/        /*height: 320px;*/        /*width: 420px;*/    }    .canvas-draw{        position: absolute;        margin: auto;        height: 240px;        width: 320px;        left: 0;        top: 0;        right: 0;        bottom: 0;     /**/        /*!*bottom: 0;*!*/        /*left: 0;*/        /*!*right: 0;*!*/    }    canvas{        width: 100%;        height: 100%;    }    .face-box{        position: relative;        height: 260px;        padding: 0;        margin: 0;    }</style>{/block}{block name="contont"}<!-- Begin page content --><div class="container">    <div class="row container-box">        <ul class="example-show" style="padding: 0px">            <li class="active" id="example-1" data="nav-1">                <div class="col-md-12 example-box">                    <div class="col-md-6 example-img-box">                        <img src="_IMG_/qrcode.png" class="example-img" id="qrcode">                    </div>                    <div class="col-md-6 example-img-box">                        <div class="example-result">                            <h4 class="title">识别结果</h4>                            <p class="text" id="qrcode-text"><i class="fa fa-spinner fa-pulse fa-5x"></i>                                <br>正在识别，请稍等……</p>                        </div>                    </div>                    <div class="col-md-12 example-upload">                        <button type="button" class="btn btn-lg btn-orange" id="qrcode-btn">本地上传</button>                        <input type="file" accept="image/*" style="display: none" for="qrcode">                    </div>                </div>            </li>            <li id="example-2" data="nav-2">                <div class="col-md-12 example-box">                    <div class="col-md-12 face-box">                        <div class="canvas-draw">                            <video id="video" width="320" height="240" preload autoplay loop muted></video>                        </div>                        <div class="canvas-draw">                            <canvas id="canvas" width="320" height="240"></canvas>                        </div>                        <!--<img src="_IMG_/faces.jpg" class="example-img" id="special">-->                    </div>                    <div class="col-md-12 example-upload">                        <button type="button" class="btn btn-lg btn-orange example-btn">本地上传</button>                        <input type="file" accept="image/*" style="display: none" for="face">                    </div>                </div>            </li>            <li id="example-3" data="nav-3">                <div class="col-md-12 example-box">                    <div class="col-md-6 example-img-box">                        <img src="_IMG_/demo/chinese_red.jpg" class="example-img" id="font">                    </div>                    <div class="col-md-6 example-img-box">                        <div class="example-result">                            <h4 class="title">识别结果</h4>                            <p class="text" id="font-text"><i class="fa fa-spinner fa-pulse fa-5x"></i>                                <br>正在识别，请稍等……</p>                        </div>                    </div>                    <div class="col-md-12 example-upload">                        <button type="button" class="btn btn-lg btn-orange example-btn">本地上传</button>                        <input type="file" accept="image/*" style="display: none" for="font">                    </div>                </div>            </li>            <li id="example-4"  data="nav-4">                <div class="col-md-12 example-box">                    <!--<div class="col-md-12 face-box">-->                        <!--<div class="canvas-draw">-->                            <!--<video id="video" width="320" height="240" preload autoplay loop muted></video>-->                        <!--</div>-->                        <!--<div class="canvas-draw">-->                            <!--<canvas id="canvas" width="320" height="240"></canvas>-->                        <!--</div>-->                        <!--&lt;!&ndash;<img src="_IMG_/faces.jpg" class="example-img" id="special">&ndash;&gt;-->                    <!--</div>-->                    <div class="col-md-12 example-upload">                        <button type="button" class="btn btn-lg btn-orange example-btn">本地上传</button>                        <input type="file" accept="image/*" style="display: none" for="special">                    </div>                </div>            </li>        </ul>        <div class="col-md-12 sideGuide text-center">            <ul class="center-block">                <li><a href="javascript:void(0)" class="example-nav active" id="nav-1" data="1">二维码识别</a></li>                <li><a href="example/face_video" class="example-nav">人脸识别</a></li>                <li><a href="example/color_video" class="example-nav">颜色识别</a></li>                <li><a href="javascript:void(0)" class="example-nav" id="nav-3" data="3">图片转文本</a></li>                <li><a href="example/fast" class="example-nav">特征值提取</a></li>            </ul>        </div>    </div></div>{/block}{block name="linkjs"}<script src="_ROOT_/text?key=57fc631cc1d38a5c77ccf70f98c7bebd" type="text/javascript" charset="utf-8"></script><script src="_ROOT_/picture?key=c192065a742d448fef1cad4089a1b09b" type="text/javascript" charset="utf-8"></script><!--<script src="_JS_/im/qrcode/llqrcode.js" type="text/javascript" charset="utf-8"></script>-->{/block}{block name="js"}<script>    function qrcode_discern(url) {        qrcode.decode(url);        qrcode.callback = function(imgMsg){            setTimeout(function () {                $('#qrcode-text').text(imgMsg);            },2000);            console.log("imgMsg"+imgMsg);            console.log("url"+url);        }    }    function font_discern(url,obj) {        Tesseract.create({            workerPath: 'http://{$Think.server.SERVER_NAME}_JS_/im/tesseract/worker.js',            langPath: 'http://{$Think.server.SERVER_NAME}_JS_/im/tesseract/langPath/',            corePath: 'http://{$Think.server.SERVER_NAME}_JS_/im/tesseract/index.js',        }).recognize(url, {            lang: 'chi_sim',            tessedit_char_blacklist: 'e'        }).then(function(result){            obj.text(result.text);            console.log(result)        });    }    //获取文件路径方法兼容    function getObjectURL(file) {        var url = null ;        if (window.createObjectURL!=undefined) { // basic            url = window.createObjectURL(file) ;        } else if (window.URL!=undefined) { // mozilla(firefox)            url = window.URL.createObjectURL(file) ;        } else if (window.webkitURL!=undefined) { // webkit or chrome            url = window.webkitURL.createObjectURL(file) ;        }        return url ;    }    //控制页面切换    $(window).bind( 'hashchange', function(e) {        var hash = window.location.hash;        $('.example-show li').hide();        $(hash).slideDown();        var nav =$(hash).attr('data');        $('.example-nav').removeClass('active');        $('#'+nav).addClass('active');    });    $(function () {        qrcode_discern('_IMG_/qrcode.png');        font_discern('_IMG_/demo/chinese_red.jpg',$('#font-text'));        //跳转页面使用        var hash = window.location.hash;        if(hash){            $('.example-show li').hide();            $(hash).slideDown();            var nav =$(hash).attr('data');            $('.example-nav').removeClass('active');            $('#'+nav).addClass('active');        }        $('#qrcode-btn').on('click',function () {            var input = $(this).siblings('input');            input.click();            input.change(function () {                var id = input.attr('for');                $('#'+id+'-text').html('<i class="fa fa-spinner fa-pulse fa-5x"></i><br>正在识别，请稍等……');                var objUrl = getObjectURL(this.files[0]);                $('#'+id).attr('src',objUrl);                qrcode_discern(objUrl);            });        });        $('.example-btn').on('click',function () {            var input = $(this).siblings('input');            input.click();            input.change(function () {                var id = input.attr('for');                $('#'+id+'-text').html('<i class="fa fa-spinner fa-pulse fa-5x"></i><br>正在识别，请稍等……');                var objUrl = getObjectURL(this.files[0]);                $('#'+id).attr('src',objUrl);                font_discern(objUrl,$('#'+id+'-text'));            });        });        $('.example-nav').on('click',function () {            //alert($(this).index());            $('.example-nav').removeClass('active');            $(this).addClass('active');            var data = $(this).attr('data');            $('.example-show li').hide();            $('#example-'+data).slideDown();        });        $('#submit').click(function () {            if($('#form').validate().form()){                $.ajax({                    url: 'upload',                    type: 'POST',                    data: $('#form').serialize(),                    success: function (result) {                        if (result.status) {                            //status为1成功                            layer.msg('' + result.msg, {                                icon: 1,                                time:3000,                                end:function(){                                    parent.location.href=parent.location.href;                                }                            });                        } else {                            layer.msg('' + result.msg, {icon: 2});                        }                    },                    error:function () {                        layer.msg('网络开小差了!', {icon: 5});                    }                });            }        })    })</script>{/block}