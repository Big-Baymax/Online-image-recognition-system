{extend name="guest@base/user"/}{block name="title"}接口使用记录{/block}{block name="css"}<style>    .dropdown-menu>li.select {        color: #262626;        text-decoration: none;        background-color: #f5f5f5;    }    .table-hover>tbody>tr:hover {        background-color: #fd7706;    }</style>{/block}{block name="navbar-two"}<li class="dropdown active">    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">接口管理<span class="caret"></span></a>    <ul class="dropdown-menu">        <li><a href="_ROOT_/user/interface/submit">申请进度</a></li>        <li><a href="_ROOT_/user/interface/key">获取KEY</a></li>        <li><a href="_ROOT_/user/interface/count">接口统计</a></li>        <li><a href="_ROOT_/user/interface/log">详细记录</a></li>    </ul></li>{/block}{block name="contont"}<!-- Begin page content --><div class="container">    <h3>接口使用详细记录</h3>    <div class="example">        <div class="btn-group hidden-xs" id="exampleToolbar" role="group">            <form id="filter">            <div class="btn-group btn-select">                <button type="button" class="btn btn-outline btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                    接口类型 <span class="caret"></span>                </button>                <input type="text" class="hidden" value="0" name="type">                <ul class="dropdown-menu">                    <li class="dropdown-option select" value="0"><a href="#">不限</a></li>                    <li class="dropdown-option" value="1"><a href="#">人脸识别</a></li>                    <li class="dropdown-option" value="2"><a href="#">图像识别</a></li>                    <li class="dropdown-option" value="3"><a href="#">印刷文字识别</a></li>                </ul>            </div>            <div class="btn-group btn-select">                <button type="button" class="btn btn-outline btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                    请求时间 <span class="caret"></span>                </button>                <input type="text" class="hidden" value="0" name="submit">                <ul class="dropdown-menu">                    <li class="dropdown-option select" value="0"><a href="#">不限</a></li>                    <li class="dropdown-option" value="1"><a href="#">今天</a></li>                    <li class="dropdown-option" value="2"><a href="#">一周内</a></li>                    <li class="dropdown-option" value="3"><a href="#">一月内</a></li>                    <li class="dropdown-option" value="4"><a href="#">一年内</a></li>                </ul>            </div>            <div class="btn-group btn-select">                <button type="button" class="btn btn-outline btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                    请求状态 <span class="caret"></span>                </button>                <input type="text" class="hidden" value="2" name="status">                <ul class="dropdown-menu">                    <li class="dropdown-option select" value="2"><a href="#">不限</a></li>                    <li class="dropdown-option" value="1"><a href="#">成功</a></li>                    <li class="dropdown-option" value="0"><a href="#">正忙</a></li>                </ul>            </div>            </form>        </div>        <table id="table" data-toggle="table" data-card-view="true" data-mobile-responsive="true" data-show-export="true">            <thead>            <tr>                <th data-field="type" data-sortable="true" data-formatter="typeFormatter">接口类型</th>                <th data-field="time" data-sortable="true">请求时间</th>                <th data-field="ip" data-sortable="true">IP</th>                <th data-field="broswer" data-sortable="true">浏览器版本</th>                <th data-field="os" data-sortable="true">系统版本</th>                <th data-field="status" data-formatter="resultFormatter" data-align="center" data-halign="center">请求状态</th>            </tr>            </thead>        </table>    </div></div>{/block}{block name="linkjs"}<link href="_CSS_/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet"><script src="_JS_/plugins/bootstrap-table/bootstrap-table.js"></script><script src="_JS_/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script><script src="_JS_/plugins/bootstrap-table/bootstrap-table-mobile.js"></script><script src="_JS_/plugins/bootstrap-table/tableExport.js"></script><script src="_JS_/plugins/bootstrap-table/bootstrap-table-export.js"></script>{/block}{block name="js"}<script>        $('#table').bootstrapTable({            pagination: true,            sidePagination: 'server',            url:'_URL_/user/interface/log/{$Think.session.user_id}',            showRefresh: true,            showToggle: true,            showColumns: true,            method:'post',            dataField:'data',//指定            pageSize: 10,            pageNumber:1,//开始的时候是第几页            pageList:[5,10, 15 ,25,'ALL'],            queryParamsType:'',            sortOrder:"desc",            // 自定义搜索参数            queryParams: formfilter,            toolbar: "#exampleToolbar",            iconSize: "outline",            icons: {                refresh: "glyphicon-repeat",                toggle: "glyphicon-list-alt",                columns: "glyphicon-list",                export: 'glyphicon glyphicon-export'            }        });        //刷新时候提交        $(".filter").click(function () {            $(".filter").removeClass("active");            $(this).addClass("active");            //重置pageSize为1            $('#table').bootstrapTable('selectPage',1);        })        function resultFormatter(e) {            if(e == 1){                return '<span class="label label-primary">成功</span>'            }else{                return '<span class="label label-danger">正忙</span>'            }        }        //type        function typeFormatter(e) {            if(e == 1){                return '人脸识别'            }else if(e == 2){                return '图像识别'            }else if(e == 3){                return '印刷文字识别'            }        }        //修改上传参数        function formfilter(params) {            var val = $("#filter").serializeArray();            for(var key in val){                params[val[key]['name']] = val[key]['value'];            }            return params;        }        //bootstrap下拉框选择结束事件        $('.btn-select').on('hidden.bs.dropdown', function () {            $(this).children('input').val($(this).children('ul').children('li.select').attr("value"));            $('#table').bootstrapTable('selectPage',1);        });        //下拉选择事件        $('.dropdown-option').click(function () {            $(this).addClass('select');            $(this).siblings('.dropdown-option').removeClass('select');        });</script>{/block}